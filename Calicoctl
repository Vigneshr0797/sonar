Below is the correct and clean step-by-step guide to implement calicoctl for Kubernetes v1.34.2 â€” including installation, configuration, and validation.

â¸»

âœ… Install & Configure calicoctl for Kubernetes v1.34.2

Calico is already part of your cluster as the CNI, but calicoctl is NOT installed by default.
calicoctl is only a management CLI to view/modify Calico objects (IPPools, BGP, Nodes, Policies, etc).

Calicoctl can be used in two modes:

â¸»

ðŸ“Œ Mode 1 â€” Calicoctl as a Standalone Binary (Recommended)

This is the simplest and most common method.

Step 1: Download calicoctl binary

curl -L https://github.com/projectcalico/calico/releases/download/v3.28.0/calicoctl-linux-amd64 -o calicoctl

Calico v3.28 works perfectly with Kubernetes v1.34.x.

Step 2: Make it executable

chmod +x calicoctl

Step 3: Move to PATH

sudo mv calicoctl /usr/local/bin/


â¸»

ðŸ“Œ Step 4: Create calicoctl configuration file

Calicoctl reads config from:
	â€¢	/etc/calico/calicoctl.cfg (recommended)
	â€¢	or --config flag
	â€¢	or environment variable

Create the config file:

sudo mkdir -p /etc/calico

Create /etc/calico/calicoctl.cfg:

sudo tee /etc/calico/calicoctl.cfg <<EOF
apiVersion: projectcalico.org/v3
kind: CalicoAPIConfig
metadata:
spec:
  datastoreType: "kubernetes"
  kubeconfig: "/etc/kubernetes/admin.conf"
EOF


â¸»

ðŸ“Œ Step 5: Verify calicoctl is working

calicoctl get nodes

You should see your Kubernetes nodes listed.

â¸»

ðŸ“Œ Useful Tests

1. View IP Pools

calicoctl get ippool

2. Describe IP Pool

calicoctl get ippool default-ipv4-ippool -o yaml

3. Check BGP Status

calicoctl node status


â¸»

ðŸ“Œ Mode 2 â€” Run calicoctl as a Kubernetes Pod (Optional)

If you want to run calicoctl inside the cluster:

kubectl apply -f https://raw.githubusercontent.com/projectcalico/calico/v3.28.0/manifests/calicoctl.yaml

Then exec:

kubectl exec -it calicoctl -- /calicoctl get nodes


â¸»

ðŸ“Œ Common Fixes

If you get:

Unauthorized: error calling Kubernetes API

Fix permissions:

sudo chmod +r /etc/kubernetes/admin.conf

Or copy admin.conf to your user home:

mkdir -p $HOME/.kube
sudo cp /etc/kubernetes/admin.conf $HOME/.kube/config
sudo chown $USER:$USER $HOME/.kube/config


â¸»

ðŸ“Œ If Calico nodes are in NotReady / BIRD not established

Check BGP connectivity:

calicoctl node status

Common issues:
	â€¢	Firewall blocking port 179
	â€¢	Nodes in different subnets without route reflectors
	â€¢	Duplicate node IPs

â¸»

ðŸŽ¯ You are now ready to manage Calico on Kubernetes v1.34.2 using calicoctl.

If you want, I can also provide:

âœ… IPPool creation
âœ… BGP peering setup
âœ… How to fix â€œBGP not establishedâ€
âœ… How to add new subnet to Calico
âœ… Calico troubleshooting commands

Would you like any of these?
